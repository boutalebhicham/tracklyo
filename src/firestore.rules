rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {

    // L'utilisateur peut lire/écrire ses propres informations
    // et lire/écrire sur ses propres sous-collections.
    match /users/{userId} {
      allow read, write: if request.auth != null && request.auth.uid == userId;

      // Ajoutez ici d'autres sous-collections si nécessaire
      match /transactions/{transactionId} {
        allow read, write: if request.auth != null && request.auth.uid == userId;
      }
      match /recaps/{recapId} {
        allow read, write: if request.auth != null && request.auth.uid == userId;
          match /comments/{commentId} {
            allow read, write: if request.auth != null; // Ou une logique plus fine
          }
      }
      match /events/{eventId} {
        allow read, write: if request.auth != null && request.auth.uid == userId;
      }
      match /documents/{documentId} {
        allow read, write: if request.auth != null && request.auth.uid == userId;
      }
    }
  }
}
